<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Sclera | The Student Academic Operating System</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Newsreader:ital,opsz,wght@0,6..72,200..800;1,6..72,200..800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- gl-matrix for Infinite Menu -->
    <script src="https://cdn.jsdelivr.net/npm/gl-matrix@3.4.3/gl-matrix-min.js"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "os-bg": "#ffffff",
                        "os-surface": "#fafafa",
                        "os-accent": "#000000",
                        "os-grey": "#f2f2f2",
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "serif": ["Newsreader", "serif"]
                    }
                },
            },
        }
    </script>
    
    <style type="text/tailwindcss">
        /* ===== CUSTOMIZATION GUIDE ===== */
        :root {
            --primary-gradient-start: #6b7280;
            --primary-gradient-end: #374151;
            --accent-color: #000000;
            --accent-dark: #111111;
        }

        /* ===== THEME VARIABLES ===== */
        html {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --text-primary: #000000;
            --text-secondary: rgba(0, 0, 0, 0.8);
            --border-color: rgba(0, 0, 0, 0.15);
            --accent-primary: #000000;
            --text-muted: rgba(0, 0, 0, 0.6);
        }
        
        html[data-theme="dark"] {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.9);
            --border-color: rgba(255, 255, 255, 0.2);
            --accent-primary: #111111;
            --text-muted: rgba(255, 255, 255, 0.7);
        }

        html { scroll-behavior: smooth; }
        
        .central-line {
            background-color: var(--text-secondary);
            opacity: 0.3;
        }

        @layer base {
            body {
                font-family: Inter, sans-serif;
                background-color: var(--bg-primary);
                color: var(--text-primary);
                overflow-x: hidden;
                -webkit-font-smoothing: antialiased;
            }
        }

        /* ===== STARTUP ANIMATION ===== */
        #startup-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: all;
            transition: opacity 1.1s cubic-bezier(0.76, 0, 0.24, 1);
        }
        #startup-overlay.reveal {
            opacity: 0;
            pointer-events: none;
        }

        /* Wordmark — clean Inter, no colour */
        .startup-wordmark {
            font-family: Inter, sans-serif;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.5em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.9);
            opacity: 0;
            transition: opacity 1s ease;
            margin-bottom: 72px;
        }
        .startup-wordmark.visible { opacity: 1; }

        /* Central progress line */
        .startup-line-wrap {
            width: 120px;
            height: 1px;
            background: rgba(255,255,255,0.08);
            overflow: hidden;
            margin-bottom: 28px;
        }
        .startup-line-fill {
            height: 100%;
            width: 0%;
            background: rgba(255,255,255,0.6);
            transition: width 2.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Status text */
        .startup-status {
            font-family: Inter, sans-serif;
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.25);
            opacity: 0;
            transition: opacity 0.6s ease;
            height: 14px;
        }
        .startup-status.visible { opacity: 1; }

        /* Bottom tagline */
        .startup-tagline {
            position: absolute;
            bottom: 36px;
            left: 50%;
            transform: translateX(-50%);
            font-family: Inter, sans-serif;
            font-size: 9px;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.18);
            opacity: 0;
            transition: opacity 1s ease;
            white-space: nowrap;
        }
        .startup-tagline.visible { opacity: 1; }

        /* Version tag — top right */
        .startup-version {
            position: absolute;
            top: 32px;
            right: 36px;
            font-family: Inter, sans-serif;
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.15);
            opacity: 0;
            transition: opacity 0.8s ease;
        }
        .startup-version.visible { opacity: 1; }
        /* ===== END STARTUP ANIMATION ===== */

        .section-spacing { @apply py-[120px]; }

        .glass-ui {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.02);
        }
        body[data-theme="dark"] .glass-ui {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(255, 255, 255, 0.02);
        }
        .glass-card {
            backdrop-filter: blur(40px);
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.02);
            transition: all 1000ms;
        }
        body[data-theme="dark"] .glass-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 50px rgba(255, 255, 255, 0.02);
        }
        .glass-card:hover {
            background: rgba(255, 255, 255, 0.6);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.04);
            transform: translateY(-8px);
        }
        body[data-theme="dark"] .glass-card:hover {
            background: rgba(0, 0, 0, 0.6);
            box-shadow: 0 30px 60px rgba(255, 255, 255, 0.04);
        }
        body[data-theme="dark"] .text-black\/50 { color: var(--text-secondary); }
        body[data-theme="dark"] .text-black\/40 { color: var(--text-secondary); }
        body[data-theme="dark"] .text-black\/30 { color: var(--text-secondary); }
        body[data-theme="dark"] .text-black\/20 { color: var(--text-secondary); }
        body[data-theme="dark"] .text-black\/60 { color: var(--text-primary); }

        /* ===== LANDING NOTCH ===== */
        html[data-theme="light"] nav,
        html[data-theme="dark"] nav {
            background: none !important;
            backdrop-filter: none !important;
            border-bottom: none !important;
        }

        .landing-notch-wrap {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Main pill */
        .landing-notch-pill {
            display: flex;
            align-items: center;
            gap: 2px;
            padding: 6px 8px;
            border-radius: 100px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            transition: box-shadow 0.3s ease, background 0.3s ease;
        }
        html[data-theme="light"] .landing-notch-pill {
            background: rgba(255,255,255,0.72);
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 4px 24px rgba(0,0,0,0.07), 0 1px 2px rgba(0,0,0,0.04);
        }
        html[data-theme="dark"] .landing-notch-pill {
            background: rgba(18,18,18,0.78);
            border: 1px solid rgba(255,255,255,0.09);
            box-shadow: 0 4px 24px rgba(0,0,0,0.4), 0 1px 2px rgba(0,0,0,0.2);
        }
        .landing-notch-pill.scrolled {
            box-shadow: 0 8px 32px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.06);
        }
        html[data-theme="dark"] .landing-notch-pill.scrolled {
            box-shadow: 0 8px 32px rgba(0,0,0,0.55), 0 2px 4px rgba(0,0,0,0.25);
        }

        /* Wordmark inside pill */
        .notch-wordmark {
            display: flex;
            align-items: center;
            gap: 7px;
            padding: 5px 12px 5px 8px;
            border-radius: 100px;
            text-decoration: none;
            margin-right: 4px;
        }
        .notch-wordmark-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            border: 1px solid currentColor;
            opacity: 0.5;
            flex-shrink: 0;
        }
        .notch-wordmark-text {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.42em;
            text-transform: uppercase;
            color: var(--text-primary);
            line-height: 1;
        }

        /* Divider */
        .notch-divider {
            width: 1px;
            height: 16px;
            background: currentColor;
            opacity: 0.12;
            margin: 0 4px;
            flex-shrink: 0;
        }

        /* Nav link items */
        .notch-nav-link {
            display: flex;
            align-items: center;
            padding: 6px 13px;
            border-radius: 100px;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.2s ease, background 0.2s ease;
            white-space: nowrap;
        }
        .notch-nav-link:hover {
            color: var(--text-primary);
        }
        html[data-theme="light"] .notch-nav-link:hover { background: rgba(0,0,0,0.04); }
        html[data-theme="dark"] .notch-nav-link:hover  { background: rgba(255,255,255,0.06); }

        /* Action buttons pill (right side) */
        .landing-notch-actions {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 5px 6px;
            border-radius: 100px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            transition: box-shadow 0.3s ease, background 0.3s ease;
        }
        html[data-theme="light"] .landing-notch-actions {
            background: rgba(255,255,255,0.72);
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 4px 24px rgba(0,0,0,0.07), 0 1px 2px rgba(0,0,0,0.04);
        }
        html[data-theme="dark"] .landing-notch-actions {
            background: rgba(18,18,18,0.78);
            border: 1px solid rgba(255,255,255,0.09);
            box-shadow: 0 4px 24px rgba(0,0,0,0.4), 0 1px 2px rgba(0,0,0,0.2);
        }

        /* Icon button */
        .notch-icon-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.2s, background 0.2s;
        }
        .notch-icon-btn:hover { color: var(--text-primary); }
        html[data-theme="light"] .notch-icon-btn:hover { background: rgba(0,0,0,0.05); }
        html[data-theme="dark"] .notch-icon-btn:hover  { background: rgba(255,255,255,0.07); }
        .notch-icon-btn .material-symbols-outlined { font-size: 17px; }

        /* CTA buttons */
        .notch-cta {
            display: inline-flex;
            align-items: center;
            padding: 7px 16px;
            border-radius: 100px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            text-decoration: none;
            transition: all 0.2s ease;
            white-space: nowrap;
            line-height: 1;
        }
        .notch-cta-ghost {
            color: var(--text-muted);
            background: none;
        }
        .notch-cta-ghost:hover { color: var(--text-primary); }
        html[data-theme="light"] .notch-cta-ghost:hover { background: rgba(0,0,0,0.05); }
        html[data-theme="dark"] .notch-cta-ghost:hover  { background: rgba(255,255,255,0.07); }

        .notch-cta-solid {
            color: #fff;
            background: rgba(0,0,0,0.88);
        }
        html[data-theme="dark"] .notch-cta-solid {
            color: #000;
            background: rgba(255,255,255,0.90);
        }
        .notch-cta-solid:hover { opacity: 0.85; transform: translateY(-1px); }
        /* ===== END LANDING NOTCH ===== */
        html[data-theme="light"] footer {
            background: rgba(255, 255, 255, 0.3);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        html[data-theme="dark"] footer {
            background: rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
        }

        .text-reveal {
            @apply opacity-0 translate-y-8 transition-all duration-[1500ms] ease-[cubic-bezier(0.2,1,0.3,1)];
        }
        .text-reveal.active { @apply opacity-100 translate-y-0; }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-gradient-start) 0%, var(--primary-gradient-end) 100%);
        }
        .btn-premium {
            @apply relative overflow-hidden px-12 py-6 rounded-full text-[11px] font-bold uppercase tracking-[0.3em] transition-all duration-500 ease-out;
        }
        html[data-theme="light"] .btn-premium {
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        html[data-theme="dark"] .btn-premium {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        html[data-theme="light"] .btn-premium:hover {
            background: rgba(0, 0, 0, 1);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        html[data-theme="dark"] .btn-premium:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.1);
        }

        .main-heading { color: var(--text-primary); }
        html[data-theme="dark"] .main-heading {
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 50%, #e0e0e0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        html[data-theme="dark"] .main-heading .italic {
            opacity: 0.9 !important;
            -webkit-text-fill-color: rgba(255, 255, 255, 0.9) !important;
        }

        .animated-gradient {
            background: linear-gradient(-45deg, #f5f5f5, #707070, #899a96, #f5f5f5);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        html[data-theme="dark"] .animated-gradient {
            background: linear-gradient(-45deg, #0a0a0a, #1a1a1a, #2a2a2a, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        .fallback-gradient {
            background: linear-gradient(-45deg, #f5f5f5, #707070, #899a96, #f5f5f5);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        html[data-theme="dark"] .fallback-gradient {
            background: linear-gradient(-45deg, #0a0a0a, #1a1a1a, #2a2a2a, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .features-bg {
            background: linear-gradient(135deg, rgba(250, 250, 250, 0.5) 0%, rgba(240, 240, 240, 0.3) 100%);
        }
        html[data-theme="dark"] .features-bg {
            background: linear-gradient(135deg, rgba(15, 15, 15, 0.5) 0%, rgba(20, 20, 20, 0.3) 100%);
        }

        /* ===== HERO NODE LAYOUT ===== */
        .hero-section {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        /* Hero center content */
        .hero-center {
            text-align: center;
            max-width: auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }

        /* Hero scroll indicator */
        .hero-scroll-indicator {
            position: absolute;
            bottom: 32px;
            left: 32px;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transition: opacity 0.6s ease 0.8s;
        }
        .hero-scroll-indicator.page-loaded { opacity: 1; }
        .hero-scroll-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounce-down 2s ease infinite;
        }
        @keyframes bounce-down {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(4px); }
        }
        .hero-scroll-text {
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        /* Hero page counter */
        .hero-page-counter {
            position: absolute;
            bottom: 32px;
            right: 32px;
            opacity: 0;
            transition: opacity 0.6s ease 0.8s;
        }
        .hero-page-counter.page-loaded { opacity: 1; }
        .hero-page-counter-text {
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        .hero-page-counter-line {
            width: 32px;
            height: 1px;
            background: var(--border-color);
            margin-top: 6px;
        }

        /* ===== INFINITE MENU SECTION ===== */
        .infinite-menu-section {
            position: relative;
            height: 640px;
            width: 100%;
            overflow: hidden;
        }
        #infinite-menu-canvas {
            cursor: grab;
            width: 100%;
            height: 100%;
            outline: none;
        }
        #infinite-menu-canvas:active { cursor: grabbing; }

        /* Feature label — top-left corner */
        .infinite-menu-label {
            position: absolute;
            top: 36px;
            left: 40px;
            opacity: 0;
            transition: opacity 500ms cubic-bezier(0.25,0.1,0.25,1);
            pointer-events: none;
            user-select: none;
        }
        .infinite-menu-label.moving {
            opacity: 0;
            transition-duration: 80ms;
        }
        .infinite-menu-label:not(.moving) { opacity: 1; }

        .infinite-menu-index {
            font-family: Inter, sans-serif;
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.45em;
            text-transform: uppercase;
            color: var(--text-muted);
            display: block;
            margin-bottom: 10px;
        }
        .infinite-menu-title {
            font-family: 'Newsreader', serif;
            font-size: clamp(2rem, 4vw, 3.2rem);
            font-weight: 300;
            font-style: italic;
            color: var(--text-primary);
            line-height: 1.05;
            display: block;
        }

        /* Description — bottom-left */
        .infinite-menu-desc {
            position: absolute;
            bottom: 36px;
            left: 40px;
            max-width: 240px;
            font-family: Inter, sans-serif;
            font-size: 16px;
            font-weight: 400;
            letter-spacing: 0.02em;
            line-height: 1.6;
            color: var(--text-muted);
            opacity: 0;
            transition: opacity 500ms cubic-bezier(0.25,0.1,0.25,1);
            pointer-events: none;
            user-select: none;
        }
        .infinite-menu-desc.moving {
            opacity: 0;
            transition-duration: 80ms;
        }
        .infinite-menu-desc:not(.moving) { opacity: 1; }

        /* CTA button — bottom-right, monochrome */
        .infinite-menu-btn {
            position: absolute;
            bottom: 36px;
            right: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 500ms cubic-bezier(0.25,0.1,0.25,1);
            user-select: none;
        }
        .infinite-menu-btn.moving {
            opacity: 0;
            transition-duration: 80ms;
        }
        .infinite-menu-btn:not(.moving) { opacity: 1; }

        .infinite-menu-btn-text {
            font-family: Inter, sans-serif;
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            color: var(--text-muted);
            transition: color 200ms;
        }
        .infinite-menu-btn-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 200ms, border-color 200ms;
        }
        html[data-theme="light"] .infinite-menu-btn-circle {
            background: rgba(0,0,0,0);
            border-color: rgba(0,0,0,0.2);
        }
        html[data-theme="dark"] .infinite-menu-btn-circle {
            background: rgba(255,255,255,0);
            border-color: rgba(255,255,255,0.2);
        }
        .infinite-menu-btn:hover .infinite-menu-btn-circle {
            background: var(--text-primary);
        }
        .infinite-menu-btn:hover .infinite-menu-btn-text { color: var(--text-primary); }
        .infinite-menu-btn:hover .infinite-menu-btn-icon { color: var(--bg-primary) !important; }

        .infinite-menu-btn-icon {
            font-size: 16px;
            color: var(--text-primary);
            transition: color 200ms;
        }

        /* Drag hint — top-right */
        .infinite-menu-hint {
            position: absolute;
            top: 36px;
            right: 40px;
            font-family: Inter, sans-serif;
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            color: var(--text-muted);
            opacity: 0.4;
            pointer-events: none;
            user-select: none;
        }
    </style>
</head>
<body>

<!-- ===== STARTUP OVERLAY ===== -->
<div id="startup-overlay">
    <div class="startup-version" id="startupVersion">v2.1.0</div>
    <div class="startup-wordmark" id="startupWordmark">Sclera</div>
    <div class="startup-line-wrap">
        <div class="startup-line-fill" id="startupLine"></div>
    </div>
    <div class="startup-status" id="startupStatus">&nbsp;</div>
    <div class="startup-tagline" id="startupTagline">The Student Academic Operating System</div>
</div>
<!-- ===== END STARTUP OVERLAY ===== -->

<!-- Grainient WebGL background -->
<div id="grainient-container" style="width: 100%; height: 100vh; position: fixed; top: 0; left: 0; z-index: -1;"></div>
<div class="fallback-gradient fixed inset-0 -z-20" id="fallback-bg"></div>

<!-- ===== NAVBAR ===== -->
<nav id="navbar" class="fixed top-0 left-0 w-full z-50 pointer-events-none">
    <div class="landing-notch-wrap pointer-events-auto" id="notchWrap">

        <!-- Main pill: wordmark + nav links -->
        <div class="landing-notch-pill" id="notchPill">

            <!-- Wordmark -->
            <a href="#" class="notch-wordmark">
                <span class="notch-wordmark-dot"></span>
                <span class="notch-wordmark-text">Sclera</span>
            </a>

            <div class="notch-divider"></div>

            <!-- Nav links -->
            <a class="notch-nav-link hidden lg:flex" href="#features">Features</a>
            <a class="notch-nav-link hidden lg:flex" href="#enterprise">Institution</a>
        </div>

        <!-- Actions pill: theme + login + signup -->
        <div class="landing-notch-actions">
            <button class="notch-icon-btn" id="themeToggle" title="Toggle theme">
                <span class="material-symbols-outlined">light_mode</span>
            </button>
            <div class="notch-divider"></div>
            <a href="{{ url_for('login') }}" class="notch-cta notch-cta-ghost">Login</a>
            <a href="{{ url_for('signup') }}" class="notch-cta notch-cta-solid">Sign Up</a>
        </div>

    </div>
</nav>

<main class="relative z-10">

    <!-- ===== HERO SECTION ===== -->
    <section class="hero-section" id="heroSection">

        <!-- Center content -->
        <div class="hero-center">
            <h1 class="font-serif text-[clamp(2.8rem,6vw,5.5rem)] leading-[1.0] tracking-tight mb-8 main-heading text-reveal" style="transition-delay: 200ms;">
                Sclera<br><span class="italic font-light opacity-50">The Student Academic OS.</span>
            </h1>

            <p class="text-base font-light theme-text-secondary mb-12 leading-relaxed text-reveal" style="transition-delay: 400ms; letter-spacing: 0.01em;">
                Academics, planning, communication, and career growth — unified into one operating system for students and institutions.
            </p>

            <div class="flex gap-6 justify-center items-center text-reveal" style="transition-delay: 600ms;">
                <a href="{{ url_for('login') }}" class="btn-premium text-xs px-8 py-4">
                    Access Dashboard
                </a>
                <a href="#features" class="text-[10px] font-bold uppercase tracking-[0.4em] opacity-40 hover:opacity-80 transition-opacity">
                    Learn More
                </a>
            </div>
        </div>

        <!-- Scroll indicator (bottom-left like inspo) -->
        <div class="hero-scroll-indicator" id="heroScrollIndicator">
            <div class="hero-scroll-btn">
                <span class="material-symbols-outlined text-[14px] theme-text-secondary">arrow_downward</span>
            </div>
            <span class="hero-scroll-text">01 / 03 · Scroll down</span>
        </div>

        <!-- Page counter (bottom-right) -->
        <div class="hero-page-counter" id="heroPageCounter">
            <span class="hero-page-counter-text">Academic OS</span>
            <div class="hero-page-counter-line"></div>
        </div>

    </section>
    <!-- ===== END HERO SECTION ===== -->

    <!-- Consolidation section -->
    <section class="section-spacing consolidation-bg" id="features">
        <div class="max-w-6xl mx-auto px-12 text-center text-reveal">
            <span class="text-[10px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-16 block">CONSOLIDATION</span>
            <h2 class="font-serif text-5xl md:text-7xl italic font-light leading-[1.2] theme-text-primary mb-12">
                Syllabus engines. Chat groups. Career portals. AI tutors. <br/>
                <span class="not-italic font-normal">One system. No compromises.</span>
            </h2>
            <p class="text-xl theme-text-secondary max-w-3xl mx-auto mb-16 leading-relaxed">
                Sclera replaces the fragmented stack of apps students and institutions rely on — bringing academic tracking, study tools, communication, and career guidance into a single coherent platform.
            </p>
            <div class="mt-20 flex flex-col items-center gap-6">
                <div class="h-16 w-[1px] central-line"></div>
            </div>
        </div>
    </section>

    <!-- Pillars section -->
    <section class="section-spacing px-12 lg:px-24" id="pillarsSection">
        <div class="flex flex-col lg:flex-row justify-between items-start gap-24 mb-32">
            <div class="max-w-2xl">
                <span class="text-[10px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-8 block">SYSTEM SNAPSHOT</span>
                <h3 class="font-serif text-6xl lg:text-7xl mb-10 leading-tight">The Four Pillars</h3>
                <p class="text-xl theme-text-secondary font-light leading-relaxed mb-8">Every feature in Sclera falls under one of four pillars — built to give students, teachers, and administrators exactly what they need, in the right context.</p>
                <div class="w-24 h-px bg-current opacity-20"></div>
            </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 max-w-6xl mx-auto">
            <div class="glass-card p-16 rounded-[3rem] group cursor-pointer pillar-card transition-all duration-500 hover:scale-105">
                <div class="flex justify-between items-start mb-8">
                    <span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">01 / Profile</span>
                    <span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors text-2xl">person</span>
                </div>
                <h4 class="font-serif text-4xl mb-6">Identity</h4>
                <p class="text-base theme-text-secondary leading-relaxed font-light mb-6">Your personal academic dashboard — customizable profile, career exploration with detailed job descriptions, internship portal, and skill assessments.</p>
                <div class="flex flex-wrap gap-2">
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Dashboard</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Career Discovery</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Internships</span>
                </div>
            </div>
            <div class="glass-card p-16 rounded-[3rem] group cursor-pointer pillar-card transition-all duration-500 hover:scale-105">
                <div class="flex justify-between items-start mb-8">
                    <span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">02 / Knowledge</span>
                    <span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors text-2xl">menu_book</span>
                </div>
                <h4 class="font-serif text-4xl mb-6">Academics</h4>
                <p class="text-base theme-text-secondary leading-relaxed font-light mb-6">Interactive syllabus tracking by subject and grade, chapter-wise progress monitoring, exam preparation mode, and subject-wise performance analytics.</p>
                <div class="flex flex-wrap gap-2">
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Syllabus</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Exam Prep</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Analytics</span>
                </div>
            </div>
            <div class="glass-card p-16 rounded-[3rem] group cursor-pointer pillar-card transition-all duration-500 hover:scale-105">
                <div class="flex justify-between items-start mb-8">
                    <span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">03 / Utility</span>
                    <span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors text-2xl">bolt</span>
                </div>
                <h4 class="font-serif text-4xl mb-6">Execution</h4>
                <p class="text-base theme-text-secondary leading-relaxed font-light mb-6">Task management with goal setting, Pomodoro study timer with progress analytics, academic calendar, and AI-powered homework assistance through ScleraAI.</p>
                <div class="flex flex-wrap gap-2">
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Tasks</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Study Timer</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">ScleraAI</span>
                </div>
            </div>
            <div class="glass-card p-16 rounded-[3rem] group cursor-pointer pillar-card transition-all duration-500 hover:scale-105">
                <div class="flex justify-between items-start mb-8">
                    <span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">04 / Network</span>
                    <span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors text-2xl">hub</span>
                </div>
                <h4 class="font-serif text-4xl mb-6">Community</h4>
                <p class="text-base theme-text-secondary leading-relaxed font-light mb-6">Bubbles — real-time topic chat groups with file sharing — plus direct messaging, class announcements, and collaborative group study sessions.</p>
                <div class="flex flex-wrap gap-2">
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Bubbles</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">Direct Messages</span>
                    <span class="text-xs px-3 py-1 rounded-full border border-current opacity-50">File Sharing</span>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== CORE CAPABILITIES with INFINITE MENU ===== -->
    <section class="section-spacing features-bg" id="institutions">
        <div class="max-w-7xl mx-auto px-12">
            <div class="text-center mb-20 text-reveal">
                <span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-8 block">FEATURE SURFACE</span>
                <h3 class="font-serif text-5xl md:text-6xl mb-8">Everything, Built In</h3>
                <p class="text-xl theme-text-secondary max-w-3xl mx-auto leading-relaxed mb-6">
                    From AI homework assistance to internship discovery, every tool a student needs is already here. Rotate the sphere to explore.
                </p>
                <p class="text-xs theme-text-secondary tracking-widest uppercase opacity-40">← Drag to explore →</p>
            </div>

            <!-- Infinite Menu Container -->
            <div class="infinite-menu-section rounded-[2rem] overflow-hidden glass-card relative" id="infiniteMenuContainer">
                <canvas id="infinite-menu-canvas"></canvas>

                <!-- Top-left: index + title -->
                <div class="infinite-menu-label" id="infiniteMenuLabel">
                    <span class="infinite-menu-index" id="infiniteMenuIndex">01 / 08</span>
                    <span class="infinite-menu-title" id="infiniteMenuTitle"></span>
                </div>

                <!-- Bottom-left: description -->
                <p class="infinite-menu-desc" id="infiniteMenuDesc"></p>

                <!-- Top-right: drag hint -->
                <span class="infinite-menu-hint">Drag to explore</span>

                <!-- Bottom-right: CTA -->
                <div class="infinite-menu-btn" id="infiniteMenuBtn">
                    <span class="infinite-menu-btn-text">Open</span>
                    <div class="infinite-menu-btn-circle">
                        <span class="material-symbols-outlined infinite-menu-btn-icon">arrow_outward</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Institution section -->
    <section class="section-spacing px-12" id="institution">
        <div class="max-w-7xl mx-auto glass-card rounded-[5rem] p-24 lg:p-40 relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-black/[0.01] to-transparent pointer-events-none"></div>
            <div class="relative z-10 text-center">
                <span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-12 block">INSTITUTIONAL TIER</span>
                <h2 class="font-serif text-6xl lg:text-8xl mb-12 max-w-5xl mx-auto leading-tight">Built for Schools.</h2>
                <p class="text-2xl font-light theme-text-secondary max-w-4xl mx-auto mb-20 leading-relaxed">
                    Administrators manage the institution, teachers manage classes, students manage themselves — each role with its own purpose-built portal and the right level of access.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-20 max-w-4xl mx-auto">
                    <div class="text-center">
                        <div class="w-20 h-20 mx-auto mb-4 rounded-full border border-current opacity-30 flex items-center justify-center">
                            <span class="material-symbols-outlined text-3xl theme-text-secondary">admin_panel_settings</span>
                        </div>
                        <h3 class="font-semibold text-lg mb-2">Administrator</h3>
                        <p class="text-sm theme-text-secondary">Institution-wide oversight, teacher management, student enrollment, and performance reporting</p>
                    </div>
                    <div class="text-center">
                        <div class="w-20 h-20 mx-auto mb-4 rounded-full border border-current opacity-30 flex items-center justify-center">
                            <span class="material-symbols-outlined text-3xl theme-text-secondary">school</span>
                        </div>
                        <h3 class="font-semibold text-lg mb-2">Teacher</h3>
                        <p class="text-sm theme-text-secondary">Class creation with invite codes, material uploads, real-time progress tracking, and at-risk student alerts</p>
                    </div>
                    <div class="text-center">
                        <div class="w-20 h-20 mx-auto mb-4 rounded-full border border-current opacity-30 flex items-center justify-center">
                            <span class="material-symbols-outlined text-3xl theme-text-secondary">person</span>
                        </div>
                        <h3 class="font-semibold text-lg mb-2">Student</h3>
                        <p class="text-sm theme-text-secondary">Personal dashboard, syllabus access, Bubbles chat, ScleraAI assistance, and career discovery tools</p>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-8 justify-center items-center">
                    <a href="{{ url_for('institution_gateway') }}" class="btn-premium bg-black text-white px-20 py-6 text-sm hover:scale-105 transition-transform">Go to Institution Gateway</a>
                    <a href="#features" class="btn-premium border border-black/10 px-20 py-6 text-sm hover:scale-105 transition-transform">See All Features</a>
                </div>
            </div>
        </div>
    </section>
</main>

<footer class="py-24 px-12 lg:px-24 bg-white border-t border-black/[0.03] flex flex-col md:flex-row justify-between items-center gap-16 relative z-20">
    <div class="flex items-center gap-4">
        <div class="fixed top-0 left-0 h-px bg-current opacity-30 z-[100] transition-all duration-300" id="scrollIndicator" style="width: 100%; transform: translateX(-100%)"></div>
        <span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-primary">Sclera / v2.1.0</span>
    </div>
    <div class="flex flex-wrap justify-center gap-12 lg:gap-24">
        <a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Ethics</a>
        <a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Privacy</a>
        <a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Documentation</a>
        <a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Manifesto</a>
    </div>
    <span class="text-[10px] uppercase tracking-[0.5em] theme-text-secondary italic font-serif text-center md:text-right">
        Designed as long-term academic infrastructure.
    </span>
</footer>

<!-- ===== SCRIPTS ===== -->
<script>
    /* ===== STARTUP ANIMATION ===== */
    (function() {
        const overlay    = document.getElementById('startup-overlay');
        const wordmark   = document.getElementById('startupWordmark');
        const line       = document.getElementById('startupLine');
        const status     = document.getElementById('startupStatus');
        const tagline    = document.getElementById('startupTagline');
        const version    = document.getElementById('startupVersion');

        const steps = ['Initializing', 'Loading modules', 'Preparing workspace', 'Ready'];
        let stepIndex = 0;
        let stepInterval;

        // Phase 1: Version tag in (200ms)
        setTimeout(() => { version.classList.add('visible'); }, 200);

        // Phase 2: Wordmark fades in (400ms)
        setTimeout(() => { wordmark.classList.add('visible'); }, 400);

        // Phase 3: Progress line starts (700ms) — 2.8s fill fills the 4s window
        setTimeout(() => { line.style.width = '100%'; }, 700);

        // Phase 4: Status text cycles (900ms)
        setTimeout(() => {
            status.textContent = steps[0];
            status.classList.add('visible');
            stepInterval = setInterval(() => {
                stepIndex++;
                if (stepIndex < steps.length) {
                    status.textContent = steps[stepIndex];
                } else {
                    clearInterval(stepInterval);
                }
            }, 850);
        }, 900);

        // Phase 5: Tagline fades in (1600ms)
        setTimeout(() => { tagline.classList.add('visible'); }, 1600);

        // Phase 6: Reveal page at 4s
        setTimeout(() => {
            overlay.classList.add('reveal');
            document.querySelectorAll('.hero-node, .hero-lines-svg, .hero-badge, .hero-scroll-indicator, .hero-page-counter').forEach(el => {
                setTimeout(() => el.classList.add('page-loaded'), 120);
            });
            setTimeout(() => {
                document.querySelectorAll('.text-reveal').forEach(el => el.classList.add('active'));
            }, 450);
        }, 4000);

        // Remove from DOM after transition completes
        setTimeout(() => { overlay.style.display = 'none'; }, 5400);
    })();

    /* ===== SCROLL BEHAVIORS ===== */
    window.addEventListener('scroll', () => {
        const scrolled = window.scrollY;
        const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrollPercent = (scrolled / totalHeight) * 100;
        const scrollIndicator = document.getElementById('scrollIndicator');
        scrollIndicator.style.transform = `translateX(${scrollPercent - 100}%)`;

        document.querySelectorAll('.text-reveal').forEach(el => {
            const elRect = el.getBoundingClientRect();
            if (elRect.top < window.innerHeight * 0.85) el.classList.add('active');
        });

        // Notch pill — deepen shadow on scroll
        const pill = document.getElementById('notchPill');
        const actions = document.querySelector('.landing-notch-actions');
        if (scrolled > 40) {
            pill?.classList.add('scrolled');
            actions?.classList.add('scrolled');
        } else {
            pill?.classList.remove('scrolled');
            actions?.classList.remove('scrolled');
        }
    });

    /* ===== THEME TOGGLE ===== */
    const themeToggle = document.getElementById('themeToggle');
    const html = document.documentElement;
    const body = document.body;
    const themeIcon = themeToggle.querySelector('span');

    const savedTheme = localStorage.getItem('sclera-theme') || 'light';
    html.setAttribute('data-theme', savedTheme);
    body.setAttribute('data-theme', savedTheme);
    updateThemeIcon(savedTheme);

    themeToggle.addEventListener('click', () => {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', newTheme);
        body.setAttribute('data-theme', newTheme);
        localStorage.setItem('sclera-theme', newTheme);
        updateThemeIcon(newTheme);
    });

    function updateThemeIcon(theme) {
        themeIcon.textContent = theme === 'dark' ? 'dark_mode' : 'light_mode';
    }

    /* ===== SMOOTH SCROLL ===== */
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
    });

    window.dispatchEvent(new Event('scroll'));
</script>

<!-- ===== GRAINIENT WEBGL ===== -->
<script>
    const hexToRgb = hex => {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        if (!result) return [1, 1, 1];
        return [parseInt(result[1], 16) / 255, parseInt(result[2], 16) / 255, parseInt(result[3], 16) / 255];
    };

    const vertexShaderSource = `
        attribute vec2 a_position;
        void main() { gl_Position = vec4(a_position, 0.0, 1.0); }
    `;

    const fragmentShaderSource = `
        precision highp float;
        uniform vec2 u_resolution;
        uniform float u_time;
        uniform float u_timeSpeed;
        uniform float u_colorBalance;
        uniform float u_warpStrength;
        uniform float u_warpFrequency;
        uniform float u_warpSpeed;
        uniform float u_warpAmplitude;
        uniform float u_blendAngle;
        uniform float u_blendSoftness;
        uniform float u_rotationAmount;
        uniform float u_noiseScale;
        uniform float u_grainAmount;
        uniform float u_grainScale;
        uniform float u_grainAnimated;
        uniform float u_contrast;
        uniform float u_gamma;
        uniform float u_saturation;
        uniform vec2 u_centerOffset;
        uniform float u_zoom;
        uniform vec3 u_color1;
        uniform vec3 u_color2;
        uniform vec3 u_color3;
        
        #define S(a,b,t) smoothstep(a,b,t)
        
        mat2 Rot(float a){ float s=sin(a),c=cos(a); return mat2(c,-s,s,c); }
        
        vec2 hash(vec2 p){
            p=vec2(dot(p,vec2(2127.1,81.17)),dot(p,vec2(1269.5,283.37)));
            return fract(sin(p)*43758.5453);
        }
        
        float noise(vec2 p){
            vec2 i=floor(p),f=fract(p),u=f*f*(3.0-2.0*f);
            float n=mix(
                mix(dot(-1.0+2.0*hash(i+vec2(0.0,0.0)),f-vec2(0.0,0.0)),
                    dot(-1.0+2.0*hash(i+vec2(1.0,0.0)),f-vec2(1.0,0.0)),u.x),
                mix(dot(-1.0+2.0*hash(i+vec2(0.0,1.0)),f-vec2(0.0,1.0)),
                    dot(-1.0+2.0*hash(i+vec2(1.0,1.0)),f-vec2(1.0,1.0)),u.x),u.y);
            return 0.5+0.5*n;
        }
        
        void main() {
            float t = u_time * u_timeSpeed;
            vec2 uv = gl_FragCoord.xy / u_resolution.xy;
            float ratio = u_resolution.x / u_resolution.y;
            vec2 tuv = uv - 0.5 + u_centerOffset;
            tuv /= max(u_zoom, 0.001);
            float degree = noise(vec2(t * 0.1, tuv.x * tuv.y) * u_noiseScale);
            tuv.y *= 1.0 / ratio;
            tuv *= Rot(radians((degree - 0.5) * u_rotationAmount + 180.0));
            tuv.y *= ratio;
            float frequency = u_warpFrequency;
            float ws = max(u_warpStrength, 0.001);
            float amplitude = u_warpAmplitude / ws;
            float warpTime = t * u_warpSpeed;
            tuv.x += sin(tuv.y * frequency + warpTime) / amplitude;
            tuv.y += sin(tuv.x * (frequency * 1.5) + warpTime) / (amplitude * 0.5);
            vec3 colLav = u_color1;
            vec3 colOrg = u_color2;
            vec3 colDark = u_color3;
            float b = u_colorBalance;
            float s = max(u_blendSoftness, 0.0);
            mat2 blendRot = Rot(radians(u_blendAngle));
            float blendX = (tuv * blendRot).x;
            float edge0 = -0.3 - b - s;
            float edge1 = 0.2 - b + s;
            float v0 = 0.5 - b + s;
            float v1 = -0.3 - b - s;
            vec3 layer1 = mix(colDark, colOrg, S(edge0, edge1, blendX));
            vec3 layer2 = mix(colOrg, colLav, S(edge0, edge1, blendX));
            vec3 col = mix(layer1, layer2, S(v0, v1, tuv.y));
            vec2 grainUv = uv * max(u_grainScale, 0.001);
            if(u_grainAnimated > 0.5){ grainUv += vec2(u_time * 0.05); }
            float grain = fract(sin(dot(grainUv, vec2(12.9898, 78.233))) * 43758.5453);
            col += (grain - 0.5) * u_grainAmount;
            col = (col - 0.5) * u_contrast + 0.5;
            float luma = dot(col, vec3(0.2126, 0.7152, 0.0722));
            col = mix(vec3(luma), col, u_saturation);
            col = pow(max(col, 0.0), vec3(1.0 / max(u_gamma, 0.001)));
            col = clamp(col, 0.0, 1.0);
            gl_FragColor = vec4(col, 1.0);
        }
    `;

    function initGrainient() {
        const container = document.getElementById('grainient-container');
        if (!container) return;
        try {
            const canvas = document.createElement('canvas');
            canvas.style.cssText = 'width:100%;height:100%;display:block;';
            container.appendChild(canvas);
            const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');
            if (!gl) throw new Error('No WebGL');
            const vs = gl.createShader(gl.VERTEX_SHADER);
            gl.shaderSource(vs, vertexShaderSource); gl.compileShader(vs);
            const fs = gl.createShader(gl.FRAGMENT_SHADER);
            gl.shaderSource(fs, fragmentShaderSource); gl.compileShader(fs);
            const program = gl.createProgram();
            gl.attachShader(program, vs); gl.attachShader(program, fs); gl.linkProgram(program);
            const positions = new Float32Array([-1,-1, 3,-1, -1,3]);
            const buf = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, buf);
            gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);
            const posLoc = gl.getAttribLocation(program, 'a_position');
            const resLoc = gl.getUniformLocation(program, 'u_resolution');
            const timeLoc = gl.getUniformLocation(program, 'u_time');
            const setUniforms = () => {
                gl.useProgram(program);
                gl.uniform2f(resLoc, canvas.width, canvas.height);
                gl.uniform1f(timeLoc, performance.now() * 0.001);
                const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                const c1 = isDark ? hexToRgb('#000000') : hexToRgb('#ffffff');
                const c2 = isDark ? hexToRgb('#374151') : hexToRgb('#9ca3af');
                const c3 = isDark ? hexToRgb('#6b7280') : hexToRgb('#e5e7eb');
                gl.uniform1f(gl.getUniformLocation(program,'u_timeSpeed'),0.5);
                gl.uniform1f(gl.getUniformLocation(program,'u_colorBalance'),0.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_warpStrength'),1.5);
                gl.uniform1f(gl.getUniformLocation(program,'u_warpFrequency'),3.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_warpSpeed'),6.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_warpAmplitude'),30.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_blendAngle'),0.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_blendSoftness'),0.8);
                gl.uniform1f(gl.getUniformLocation(program,'u_rotationAmount'),300.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_noiseScale'),1.5);
                gl.uniform1f(gl.getUniformLocation(program,'u_grainAmount'),0.25);
                gl.uniform1f(gl.getUniformLocation(program,'u_grainScale'),3.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_grainAnimated'),0.01);
                gl.uniform1f(gl.getUniformLocation(program,'u_contrast'),1.2);
                gl.uniform1f(gl.getUniformLocation(program,'u_gamma'),1.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_saturation'),1.0);
                gl.uniform2f(gl.getUniformLocation(program,'u_centerOffset'),0.0,0.0);
                gl.uniform1f(gl.getUniformLocation(program,'u_zoom'),0.8);
                gl.uniform3fv(gl.getUniformLocation(program,'u_color1'),c1);
                gl.uniform3fv(gl.getUniformLocation(program,'u_color2'),c2);
                gl.uniform3fv(gl.getUniformLocation(program,'u_color3'),c3);
            };
            const render = () => {
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                gl.viewport(0,0,canvas.width,canvas.height);
                setUniforms();
                gl.clearColor(0,0,0,1); gl.clear(gl.COLOR_BUFFER_BIT);
                gl.useProgram(program);
                gl.enableVertexAttribArray(posLoc);
                gl.bindBuffer(gl.ARRAY_BUFFER, buf);
                gl.vertexAttribPointer(posLoc,2,gl.FLOAT,false,0,0);
                gl.drawArrays(gl.TRIANGLES,0,3);
                requestAnimationFrame(render);
            };
            render();
            const fb = document.getElementById('fallback-bg');
            if (fb) fb.style.display = 'none';
        } catch(e) { console.error('Grainient error:', e); }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initGrainient);
    } else {
        initGrainient();
    }
</script>

<!-- ===== INFINITE MENU WebGL ===== -->
<script>
(function() {
    // Wait for gl-matrix to load
    function waitForGlMatrix(cb) {
        if (typeof glMatrix !== 'undefined') { cb(); }
        else { setTimeout(() => waitForGlMatrix(cb), 50); }
    }

    waitForGlMatrix(function() {
        const { mat4, quat, vec2, vec3 } = glMatrix;

        // ---- SHADERS ----
        const discVertShaderSource = `#version 300 es
uniform mat4 uWorldMatrix;
uniform mat4 uViewMatrix;
uniform mat4 uProjectionMatrix;
uniform vec3 uCameraPosition;
uniform vec4 uRotationAxisVelocity;
in vec3 aModelPosition;
in vec3 aModelNormal;
in vec2 aModelUvs;
in mat4 aInstanceMatrix;
out vec2 vUvs;
out float vAlpha;
flat out int vInstanceId;
#define PI 3.141593
void main() {
    vec4 worldPosition = uWorldMatrix * aInstanceMatrix * vec4(aModelPosition, 1.);
    vec3 centerPos = (uWorldMatrix * aInstanceMatrix * vec4(0., 0., 0., 1.)).xyz;
    float radius = length(centerPos.xyz);
    if (gl_VertexID > 0) {
        vec3 rotationAxis = uRotationAxisVelocity.xyz;
        float rotationVelocity = min(.15, uRotationAxisVelocity.w * 15.);
        vec3 stretchDir = normalize(cross(centerPos, rotationAxis));
        vec3 relativeVertexPos = normalize(worldPosition.xyz - centerPos);
        float strength = dot(stretchDir, relativeVertexPos);
        float invAbsStrength = min(0., abs(strength) - 1.);
        strength = rotationVelocity * sign(strength) * abs(invAbsStrength * invAbsStrength * invAbsStrength + 1.);
        worldPosition.xyz += stretchDir * strength;
    }
    worldPosition.xyz = radius * normalize(worldPosition.xyz);
    gl_Position = uProjectionMatrix * uViewMatrix * worldPosition;
    vAlpha = smoothstep(0.5, 1., normalize(worldPosition.xyz).z) * .9 + .1;
    vUvs = aModelUvs;
    vInstanceId = gl_InstanceID;
}`;

        const discFragShaderSource = `#version 300 es
precision highp float;
uniform sampler2D uTex;
uniform int uItemCount;
uniform int uAtlasSize;
out vec4 outColor;
in vec2 vUvs;
in float vAlpha;
flat in int vInstanceId;
void main() {
    int itemIndex = vInstanceId % uItemCount;
    int cellsPerRow = uAtlasSize;
    int cellX = itemIndex % cellsPerRow;
    int cellY = itemIndex / cellsPerRow;
    vec2 cellSize = vec2(1.0) / vec2(float(cellsPerRow));
    vec2 cellOffset = vec2(float(cellX), float(cellY)) * cellSize;
    ivec2 texSize = textureSize(uTex, 0);
    float imageAspect = float(texSize.x) / float(texSize.y);
    float scale = max(imageAspect / 1.0, 1.0 / imageAspect);
    vec2 st = vec2(vUvs.x, 1.0 - vUvs.y);
    st = (st - 0.5) * scale + 0.5;
    st = clamp(st, 0.0, 1.0);
    st = st * cellSize + cellOffset;
    outColor = texture(uTex, st);
    outColor.a *= vAlpha;
}`;

        // ---- GEOMETRY ----
        class Face { constructor(a,b,c){this.a=a;this.b=b;this.c=c;} }
        class Vertex { constructor(x,y,z){this.position=vec3.fromValues(x,y,z);this.normal=vec3.create();this.uv=vec2.create();} }
        class Geometry {
            constructor(){this.vertices=[];this.faces=[];}
            addVertex(...args){for(let i=0;i<args.length;i+=3)this.vertices.push(new Vertex(args[i],args[i+1],args[i+2]));return this;}
            addFace(...args){for(let i=0;i<args.length;i+=3)this.faces.push(new Face(args[i],args[i+1],args[i+2]));return this;}
            get lastVertex(){return this.vertices[this.vertices.length-1];}
            subdivide(divisions=1){
                const cache={};let f=this.faces;
                for(let d=0;d<divisions;++d){
                    const nf=new Array(f.length*4);
                    f.forEach((face,ndx)=>{
                        const mAB=this.getMidPoint(face.a,face.b,cache);
                        const mBC=this.getMidPoint(face.b,face.c,cache);
                        const mCA=this.getMidPoint(face.c,face.a,cache);
                        const i=ndx*4;
                        nf[i]=new Face(face.a,mAB,mCA);nf[i+1]=new Face(face.b,mBC,mAB);
                        nf[i+2]=new Face(face.c,mCA,mBC);nf[i+3]=new Face(mAB,mBC,mCA);
                    });
                    f=nf;
                }
                this.faces=f;return this;
            }
            spherize(radius=1){this.vertices.forEach(v=>{vec3.normalize(v.normal,v.position);vec3.scale(v.position,v.normal,radius);});return this;}
            get vertexData(){return new Float32Array(this.vertices.flatMap(v=>Array.from(v.position)));}
            get normalData(){return new Float32Array(this.vertices.flatMap(v=>Array.from(v.normal)));}
            get uvData(){return new Float32Array(this.vertices.flatMap(v=>Array.from(v.uv)));}
            get indexData(){return new Uint16Array(this.faces.flatMap(f=>[f.a,f.b,f.c]));}
            get data(){return{vertices:this.vertexData,indices:this.indexData,normals:this.normalData,uvs:this.uvData};}
            getMidPoint(ndxA,ndxB,cache){
                const key=ndxA<ndxB?`k_${ndxB}_${ndxA}`:`k_${ndxA}_${ndxB}`;
                if(Object.prototype.hasOwnProperty.call(cache,key))return cache[key];
                const a=this.vertices[ndxA].position,b=this.vertices[ndxB].position;
                const ndx=this.vertices.length;cache[key]=ndx;
                this.addVertex((a[0]+b[0])*.5,(a[1]+b[1])*.5,(a[2]+b[2])*.5);
                return ndx;
            }
        }
        class IcosahedronGeometry extends Geometry {
            constructor(){
                super();const t=Math.sqrt(5)*.5+.5;
                this.addVertex(-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1)
                .addFace(0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1);
            }
        }
        class DiscGeometry extends Geometry {
            constructor(steps=4,radius=1){
                super();steps=Math.max(4,steps);
                const alpha=(2*Math.PI)/steps;
                this.addVertex(0,0,0);this.lastVertex.uv[0]=.5;this.lastVertex.uv[1]=.5;
                for(let i=0;i<steps;++i){
                    const x=Math.cos(alpha*i),y=Math.sin(alpha*i);
                    this.addVertex(radius*x,radius*y,0);
                    this.lastVertex.uv[0]=x*.5+.5;this.lastVertex.uv[1]=y*.5+.5;
                    if(i>0)this.addFace(0,i,i+1);
                }
                this.addFace(0,steps,1);
            }
        }

        // ---- WebGL UTILS ----
        function createShader(gl,type,src){
            const s=gl.createShader(type);gl.shaderSource(s,src);gl.compileShader(s);
            if(gl.getShaderParameter(s,gl.COMPILE_STATUS))return s;
            console.error(gl.getShaderInfoLog(s));gl.deleteShader(s);return null;
        }
        function createProgram(gl,srcs,tfv,attribLocs){
            const p=gl.createProgram();
            [gl.VERTEX_SHADER,gl.FRAGMENT_SHADER].forEach((type,ndx)=>{
                const s=createShader(gl,type,srcs[ndx]);if(s)gl.attachShader(p,s);
            });
            if(tfv)gl.transformFeedbackVaryings(p,tfv,gl.SEPARATE_ATTRIBS);
            if(attribLocs)for(const a in attribLocs)gl.bindAttribLocation(p,attribLocs[a],a);
            gl.linkProgram(p);
            if(gl.getProgramParameter(p,gl.LINK_STATUS))return p;
            console.error(gl.getProgramInfoLog(p));gl.deleteProgram(p);return null;
        }
        function makeVertexArray(gl,bufLocNumElmPairs,indices){
            const va=gl.createVertexArray();gl.bindVertexArray(va);
            for(const[buf,loc,numElem]of bufLocNumElmPairs){
                if(loc===-1)continue;
                gl.bindBuffer(gl.ARRAY_BUFFER,buf);gl.enableVertexAttribArray(loc);
                gl.vertexAttribPointer(loc,numElem,gl.FLOAT,false,0,0);
            }
            if(indices){const ib=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,ib);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(indices),gl.STATIC_DRAW);}
            gl.bindVertexArray(null);return va;
        }
        function resizeCanvasToDisplaySize(canvas){
            const dpr=Math.min(2,window.devicePixelRatio);
            const dw=Math.round(canvas.clientWidth*dpr),dh=Math.round(canvas.clientHeight*dpr);
            const needResize=canvas.width!==dw||canvas.height!==dh;
            if(needResize){canvas.width=dw;canvas.height=dh;}
            return needResize;
        }
        function makeBuffer(gl,sizeOrData,usage){
            const buf=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buf);
            gl.bufferData(gl.ARRAY_BUFFER,sizeOrData,usage);gl.bindBuffer(gl.ARRAY_BUFFER,null);return buf;
        }
        function createAndSetupTexture(gl,minFilter,magFilter,wrapS,wrapT){
            const tex=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,tex);
            gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS);
            gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT);
            gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter);
            gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter);
            return tex;
        }

        // ---- ARCBALL CONTROL ----
        class ArcballControl {
            constructor(canvas, updateCallback) {
                this.canvas=canvas;this.updateCallback=updateCallback||(() => null);
                this.isPointerDown=false;
                this.orientation=quat.create();this.pointerRotation=quat.create();
                this.rotationVelocity=0;this.rotationAxis=vec3.fromValues(1,0,0);
                this.snapDirection=vec3.fromValues(0,0,-1);this.snapTargetDirection=null;
                this.EPSILON=0.1;this.IDENTITY_QUAT=quat.create();
                this.pointerPos=vec2.create();this.previousPointerPos=vec2.create();
                this._rotationVelocity=0;this._combinedQuat=quat.create();
                canvas.addEventListener('pointerdown',e=>{vec2.set(this.pointerPos,e.clientX,e.clientY);vec2.copy(this.previousPointerPos,this.pointerPos);this.isPointerDown=true;});
                canvas.addEventListener('pointerup',()=>{this.isPointerDown=false;});
                canvas.addEventListener('pointerleave',()=>{this.isPointerDown=false;});
                canvas.addEventListener('pointermove',e=>{if(this.isPointerDown)vec2.set(this.pointerPos,e.clientX,e.clientY);});
                canvas.style.touchAction='none';
            }
            update(deltaTime,targetFrameDuration=16){
                const ts=deltaTime/targetFrameDuration+0.00001;let af=ts;let snapRot=quat.create();
                if(this.isPointerDown){
                    const INTENSITY=0.3*ts,ANGLE_AMP=5/ts;
                    const mid=vec2.sub(vec2.create(),this.pointerPos,this.previousPointerPos);
                    vec2.scale(mid,mid,INTENSITY);
                    if(vec2.sqrLen(mid)>this.EPSILON){
                        vec2.add(mid,this.previousPointerPos,mid);
                        const p=this._project(mid),q=this._project(this.previousPointerPos);
                        const a=vec3.normalize(vec3.create(),p),b=vec3.normalize(vec3.create(),q);
                        vec2.copy(this.previousPointerPos,mid);af*=ANGLE_AMP;
                        this.quatFromVectors(a,b,this.pointerRotation,af);
                    } else {quat.slerp(this.pointerRotation,this.pointerRotation,this.IDENTITY_QUAT,INTENSITY);}
                } else {
                    quat.slerp(this.pointerRotation,this.pointerRotation,this.IDENTITY_QUAT,0.1*ts);
                    if(this.snapTargetDirection){
                        const SNAP=0.2,a=this.snapTargetDirection,b=this.snapDirection;
                        const sqrDist=vec3.squaredDistance(a,b),df=Math.max(0.1,1-sqrDist*10);
                        af*=SNAP*df;this.quatFromVectors(a,b,snapRot,af);
                    }
                }
                const combined=quat.multiply(quat.create(),snapRot,this.pointerRotation);
                this.orientation=quat.multiply(quat.create(),combined,this.orientation);
                quat.normalize(this.orientation,this.orientation);
                quat.slerp(this._combinedQuat,this._combinedQuat,combined,0.8*ts);
                quat.normalize(this._combinedQuat,this._combinedQuat);
                const rad=Math.acos(this._combinedQuat[3])*2.0,s=Math.sin(rad/2.0);
                let rv=0;
                if(s>0.000001){rv=rad/(2*Math.PI);this.rotationAxis[0]=this._combinedQuat[0]/s;this.rotationAxis[1]=this._combinedQuat[1]/s;this.rotationAxis[2]=this._combinedQuat[2]/s;}
                this._rotationVelocity+=(rv-this._rotationVelocity)*0.5*ts;
                this.rotationVelocity=this._rotationVelocity/ts;
                this.updateCallback(deltaTime);
            }
            quatFromVectors(a,b,out,af=1){
                const axis=vec3.cross(vec3.create(),a,b);vec3.normalize(axis,axis);
                const d=Math.max(-1,Math.min(1,vec3.dot(a,b)));
                const angle=Math.acos(d)*af;quat.setAxisAngle(out,axis,angle);return{q:out,axis,angle};
            }
            _project(pos){
                const r=2,w=this.canvas.clientWidth,h=this.canvas.clientHeight,s=Math.max(w,h)-1;
                const x=(2*pos[0]-w-1)/s,y=(2*pos[1]-h-1)/s;let z=0;
                const xySq=x*x+y*y,rSq=r*r;
                if(xySq<=rSq/2.0){z=Math.sqrt(rSq-xySq);}else{z=rSq/Math.sqrt(xySq);}
                return vec3.fromValues(-x,y,z);
            }
        }

        // ---- INFINITE GRID MENU ----
        class InfiniteGridMenu {
            constructor(canvas,items,onActiveItemChange,onMovementChange,onInit=null){
                this.TARGET_FRAME_DURATION=1000/60;this.SPHERE_RADIUS=2;
                this._time=0;this._deltaTime=0;this._deltaFrames=0;this._frames=0;
                this.camera={matrix:mat4.create(),near:0.1,far:40,fov:Math.PI/4,aspect:1,
                    position:vec3.fromValues(0,0,3),up:vec3.fromValues(0,1,0),
                    matrices:{view:mat4.create(),projection:mat4.create(),inversProjection:mat4.create()}};
                this.nearestVertexIndex=null;this.smoothRotationVelocity=0;this.scaleFactor=1.0;this.movementActive=false;
                this.canvas=canvas;this.items=items||[];
                this.onActiveItemChange=onActiveItemChange||(() => {});
                this.onMovementChange=onMovementChange||(() => {});
                this._init(onInit);
            }
            resize(){
                this.viewportSize=vec2.set(this.viewportSize||vec2.create(),this.canvas.clientWidth,this.canvas.clientHeight);
                const gl=this.gl;const needsResize=resizeCanvasToDisplaySize(gl.canvas);
                if(needsResize)gl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);
                this._updateProjectionMatrix(gl);
            }
            run(time=0){
                this._deltaTime=Math.min(32,time-this._time);this._time=time;
                this._deltaFrames=this._deltaTime/this.TARGET_FRAME_DURATION;
                this._frames+=this._deltaFrames;
                this._animate(this._deltaTime);this._render();
                requestAnimationFrame(t=>this.run(t));
            }
            _init(onInit){
                this.gl=this.canvas.getContext('webgl2',{antialias:true,alpha:true});
                const gl=this.gl;if(!gl)throw new Error('No WebGL 2!');
                this.viewportSize=vec2.fromValues(this.canvas.clientWidth,this.canvas.clientHeight);
                this.discProgram=createProgram(gl,[discVertShaderSource,discFragShaderSource],null,{aModelPosition:0,aModelNormal:1,aModelUvs:2,aInstanceMatrix:3});
                this.discLocations={
                    aModelPosition:gl.getAttribLocation(this.discProgram,'aModelPosition'),
                    aModelUvs:gl.getAttribLocation(this.discProgram,'aModelUvs'),
                    aInstanceMatrix:gl.getAttribLocation(this.discProgram,'aInstanceMatrix'),
                    uWorldMatrix:gl.getUniformLocation(this.discProgram,'uWorldMatrix'),
                    uViewMatrix:gl.getUniformLocation(this.discProgram,'uViewMatrix'),
                    uProjectionMatrix:gl.getUniformLocation(this.discProgram,'uProjectionMatrix'),
                    uCameraPosition:gl.getUniformLocation(this.discProgram,'uCameraPosition'),
                    uRotationAxisVelocity:gl.getUniformLocation(this.discProgram,'uRotationAxisVelocity'),
                    uTex:gl.getUniformLocation(this.discProgram,'uTex'),
                    uFrames:gl.getUniformLocation(this.discProgram,'uFrames'),
                    uItemCount:gl.getUniformLocation(this.discProgram,'uItemCount'),
                    uAtlasSize:gl.getUniformLocation(this.discProgram,'uAtlasSize'),
                    uScaleFactor:gl.getUniformLocation(this.discProgram,'uScaleFactor')
                };
                this.discGeo=new DiscGeometry(56,1);
                this.discBuffers=this.discGeo.data;
                this.discVAO=makeVertexArray(gl,[[makeBuffer(gl,this.discBuffers.vertices,gl.STATIC_DRAW),this.discLocations.aModelPosition,3],[makeBuffer(gl,this.discBuffers.uvs,gl.STATIC_DRAW),this.discLocations.aModelUvs,2]],this.discBuffers.indices);
                this.icoGeo=new IcosahedronGeometry();
                this.icoGeo.subdivide(1).spherize(this.SPHERE_RADIUS);
                this.instancePositions=this.icoGeo.vertices.map(v=>v.position);
                this.DISC_INSTANCE_COUNT=this.icoGeo.vertices.length;
                this._initDiscInstances(this.DISC_INSTANCE_COUNT);
                this.worldMatrix=mat4.create();
                this._initTexture();
                this.control=new ArcballControl(this.canvas,dt=>this._onControlUpdate(dt));
                this._updateCameraMatrix();this._updateProjectionMatrix(gl);this.resize();
                if(onInit)onInit(this);
            }
            _initTexture(){
                const gl=this.gl;
                this.tex=createAndSetupTexture(gl,gl.LINEAR,gl.LINEAR,gl.CLAMP_TO_EDGE,gl.CLAMP_TO_EDGE);
                const itemCount=Math.max(1,this.items.length);
                this.atlasSize=Math.ceil(Math.sqrt(itemCount));
                const canvas=document.createElement('canvas');const ctx=canvas.getContext('2d');
                const cellSize=512;canvas.width=this.atlasSize*cellSize;canvas.height=this.atlasSize*cellSize;

                // Helper: wrap text into lines that fit maxWidth
                function wrapText(ctx, text, maxWidth) {
                    const words = text.split(' ');
                    const lines = [];
                    let current = '';
                    for (const word of words) {
                        const test = current ? current + ' ' + word : word;
                        if (ctx.measureText(test).width > maxWidth && current) {
                            lines.push(current);
                            current = word;
                        } else {
                            current = test;
                        }
                    }
                    if (current) lines.push(current);
                    return lines;
                }

                // Icons mapped to each item by index (using unicode/text glyphs)
                const icons = ['◈', '◎', '◆', '◉', '◐', '◑'];

                // Draw refined monochrome tiles
                this.items.forEach((item, i) => {
                    const x = (i % this.atlasSize) * cellSize;
                    const y = Math.floor(i / this.atlasSize) * cellSize;
                    const cx = x + cellSize / 2;
                    const cy = y + cellSize / 2;

                    // Base fill
                    ctx.fillStyle = item.color || '#1a1a1a';
                    ctx.fillRect(x, y, cellSize, cellSize);

                    // Monochromatic radial gradient — centre light, edges dark
                    const radGrad = ctx.createRadialGradient(cx, cy - 40, 0, cx, cy - 40, cellSize * 0.75);
                    radGrad.addColorStop(0, 'rgba(255,255,255,0.10)');
                    radGrad.addColorStop(0.55, 'rgba(255,255,255,0.02)');
                    radGrad.addColorStop(1, 'rgba(0,0,0,0.22)');
                    ctx.fillStyle = radGrad;
                    ctx.fillRect(x, y, cellSize, cellSize);

                    // Top-left linear sweep for depth
                    const linGrad = ctx.createLinearGradient(x, y, x + cellSize, y + cellSize);
                    linGrad.addColorStop(0, 'rgba(255,255,255,0.05)');
                    linGrad.addColorStop(1, 'rgba(0,0,0,0.08)');
                    ctx.fillStyle = linGrad;
                    ctx.fillRect(x, y, cellSize, cellSize);

                    // Icon — small, centred above title
                    ctx.fillStyle = 'rgba(255,255,255,0.22)';
                    ctx.font = '600 64px serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(icons[i % icons.length], cx, cy - 100);

                    // Divider line under icon
                    ctx.strokeStyle = 'rgba(255,255,255,0.10)';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(cx - 48, cy - 42);
                    ctx.lineTo(cx + 48, cy - 42);
                    ctx.stroke();

                    // Title — bold Inter, auto-sized to fit
                    const maxW = cellSize * 0.72;
                    let fontSize = 68;
                    ctx.font = `600 ${fontSize}px Inter, sans-serif`;
                    while (ctx.measureText(item.title).width > maxW && fontSize > 30) {
                        fontSize -= 4;
                        ctx.font = `600 ${fontSize}px Inter, sans-serif`;
                    }
                    ctx.fillStyle = 'rgba(255,255,255,0.90)';
                    ctx.textBaseline = 'top';
                    const titleLines = wrapText(ctx, item.title, maxW);
                    const lineH = fontSize * 1.15;
                    const titleBlockH = titleLines.length * lineH;
                    const titleStartY = cy - 10;
                    titleLines.forEach((line, li) => {
                        ctx.fillText(line, cx, titleStartY + li * lineH);
                    });

                    // Subtitle / short label — small caps style
                    if (item.label) {
                        ctx.font = '500 22px Inter, sans-serif';
                        ctx.fillStyle = 'rgba(255,255,255,0.35)';
                        ctx.textBaseline = 'top';
                        ctx.fillText(item.label.toUpperCase(), cx, titleStartY + titleBlockH + 18);
                    }
                });
                gl.bindTexture(gl.TEXTURE_2D,this.tex);
                gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,canvas);
                gl.generateMipmap(gl.TEXTURE_2D);
                // Load actual images
                Promise.all(this.items.map(item=>new Promise(resolve=>{
                    const img=new Image();img.crossOrigin='anonymous';
                    img.onload=()=>resolve({img,index:this.items.indexOf(item)});
                    img.onerror=()=>resolve(null);img.src=item.image;
                }))).then(results=>{
                    results.forEach(r=>{
                        if(!r)return;
                        const{img,index}=r;
                        const x=(index%this.atlasSize)*cellSize;const y=Math.floor(index/this.atlasSize)*cellSize;
                        ctx.drawImage(img,x,y,cellSize,cellSize);
                    });
                    gl.bindTexture(gl.TEXTURE_2D,this.tex);
                    gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,canvas);
                    gl.generateMipmap(gl.TEXTURE_2D);
                });
            }
            _initDiscInstances(count){
                const gl=this.gl;
                this.discInstances={matricesArray:new Float32Array(count*16),matrices:[],buffer:gl.createBuffer()};
                for(let i=0;i<count;++i){
                    const arr=new Float32Array(this.discInstances.matricesArray.buffer,i*16*4,16);
                    arr.set(mat4.create());this.discInstances.matrices.push(arr);
                }
                gl.bindVertexArray(this.discVAO);gl.bindBuffer(gl.ARRAY_BUFFER,this.discInstances.buffer);
                gl.bufferData(gl.ARRAY_BUFFER,this.discInstances.matricesArray.byteLength,gl.DYNAMIC_DRAW);
                for(let j=0;j<4;++j){
                    const loc=this.discLocations.aInstanceMatrix+j;
                    gl.enableVertexAttribArray(loc);gl.vertexAttribPointer(loc,4,gl.FLOAT,false,64,j*16);
                    gl.vertexAttribDivisor(loc,1);
                }
                gl.bindBuffer(gl.ARRAY_BUFFER,null);gl.bindVertexArray(null);
            }
            _animate(deltaTime){
                const gl=this.gl;this.control.update(deltaTime,this.TARGET_FRAME_DURATION);
                const positions=this.instancePositions.map(p=>vec3.transformQuat(vec3.create(),p,this.control.orientation));
                const scale=0.25,SCALE_INTENSITY=0.6;
                positions.forEach((p,ndx)=>{
                    const s=(Math.abs(p[2])/this.SPHERE_RADIUS)*SCALE_INTENSITY+(1-SCALE_INTENSITY);
                    const fs=s*scale;const matrix=mat4.create();
                    mat4.multiply(matrix,matrix,mat4.fromTranslation(mat4.create(),vec3.negate(vec3.create(),p)));
                    mat4.multiply(matrix,matrix,mat4.targetTo(mat4.create(),[0,0,0],p,[0,1,0]));
                    mat4.multiply(matrix,matrix,mat4.fromScaling(mat4.create(),[fs,fs,fs]));
                    mat4.multiply(matrix,matrix,mat4.fromTranslation(mat4.create(),[0,0,-this.SPHERE_RADIUS]));
                    mat4.copy(this.discInstances.matrices[ndx],matrix);
                });
                gl.bindBuffer(gl.ARRAY_BUFFER,this.discInstances.buffer);
                gl.bufferSubData(gl.ARRAY_BUFFER,0,this.discInstances.matricesArray);
                gl.bindBuffer(gl.ARRAY_BUFFER,null);
                this.smoothRotationVelocity=this.control.rotationVelocity;
            }
            _render(){
                const gl=this.gl;gl.useProgram(this.discProgram);
                gl.enable(gl.CULL_FACE);gl.enable(gl.DEPTH_TEST);
                gl.enable(gl.BLEND);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);
                gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);
                gl.uniformMatrix4fv(this.discLocations.uWorldMatrix,false,this.worldMatrix);
                gl.uniformMatrix4fv(this.discLocations.uViewMatrix,false,this.camera.matrices.view);
                gl.uniformMatrix4fv(this.discLocations.uProjectionMatrix,false,this.camera.matrices.projection);
                gl.uniform3f(this.discLocations.uCameraPosition,...this.camera.position);
                gl.uniform4f(this.discLocations.uRotationAxisVelocity,...this.control.rotationAxis,this.smoothRotationVelocity*1.1);
                gl.uniform1i(this.discLocations.uItemCount,this.items.length);
                gl.uniform1i(this.discLocations.uAtlasSize,this.atlasSize);
                gl.uniform1f(this.discLocations.uFrames,this._frames);
                gl.uniform1f(this.discLocations.uScaleFactor,this.scaleFactor||1);
                gl.uniform1i(this.discLocations.uTex,0);
                gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,this.tex);
                gl.bindVertexArray(this.discVAO);
                gl.drawElementsInstanced(gl.TRIANGLES,this.discBuffers.indices.length,gl.UNSIGNED_SHORT,0,this.DISC_INSTANCE_COUNT);
            }
            _updateCameraMatrix(){
                mat4.targetTo(this.camera.matrix,this.camera.position,[0,0,0],this.camera.up);
                mat4.invert(this.camera.matrices.view,this.camera.matrix);
            }
            _updateProjectionMatrix(gl){
                this.camera.aspect=gl.canvas.clientWidth/gl.canvas.clientHeight;
                const height=this.SPHERE_RADIUS*0.35,distance=this.camera.position[2];
                this.camera.fov=this.camera.aspect>1?2*Math.atan(height/distance):2*Math.atan(height/this.camera.aspect/distance);
                mat4.perspective(this.camera.matrices.projection,this.camera.fov,this.camera.aspect,this.camera.near,this.camera.far);
                mat4.invert(this.camera.matrices.inversProjection,this.camera.matrices.projection);
            }
            _onControlUpdate(deltaTime){
                const ts=deltaTime/this.TARGET_FRAME_DURATION+0.0001;
                let damping=5/ts,cameraTargetZ=3;
                const isMoving=this.control.isPointerDown||Math.abs(this.smoothRotationVelocity)>0.01;
                if(isMoving!==this.movementActive){this.movementActive=isMoving;this.onMovementChange(isMoving);}
                if(!this.control.isPointerDown){
                    const ni=this._findNearestVertexIndex();
                    const itemIndex=ni%Math.max(1,this.items.length);
                    this.onActiveItemChange(itemIndex);
                    const snapDir=vec3.normalize(vec3.create(),this._getVertexWorldPosition(ni));
                    this.control.snapTargetDirection=snapDir;
                } else {cameraTargetZ+=this.control.rotationVelocity*80+2.5;damping=7/ts;}
                this.camera.position[2]+=(cameraTargetZ-this.camera.position[2])/damping;
                this._updateCameraMatrix();
            }
            _findNearestVertexIndex(){
                const n=this.control.snapDirection;
                const inv=quat.conjugate(quat.create(),this.control.orientation);
                const nt=vec3.transformQuat(vec3.create(),n,inv);
                let maxD=-1,ni;
                for(let i=0;i<this.instancePositions.length;++i){
                    const d=vec3.dot(nt,this.instancePositions[i]);if(d>maxD){maxD=d;ni=i;}
                }
                return ni;
            }
            _getVertexWorldPosition(index){
                return vec3.transformQuat(vec3.create(),this.instancePositions[index],this.control.orientation);
            }
        }

        // ---- INIT INFINITE MENU ----
        const infiniteMenuItems = [
            {
                
                color: '#1c1c1c',
                link: '/login',
                title: 'ScleraAI',
                label: 'AI · 24/7 Support',
                description: 'AI-powered homework assistance, practice question generation, and a 24/7 academic support chatbot'
            },
            {
               
                color: '#2a2a2a',
                link: '/login',
                title: 'Academics',
                label: 'Syllabus · Exam Prep',
                description: 'Interactive syllabus tracking, chapter-wise progress monitoring, and focused exam preparation mode'
            },
            {
                
                color: '#202020',
                link: '/login',
                title: 'Study Mode',
                label: 'Focus · Pomodoro',
                description: 'Distraction-free study sessions with Pomodoro timer, session analytics, and goal milestone tracking'
            },
            {
                
                color: '#181818',
                link: '/login',
                title: 'Bubbles',
                label: 'Chat · Collaborate',
                description: 'Real-time topic discussion groups, direct messaging, file sharing, and collaborative study sessions'
            },
            {
                
                color: '#242424',
                link: '/login',
                title: 'Careers',
                label: 'Jobs · Internships',
                description: 'Career exploration with job descriptions, course recommendations, internship portal, and skill assessments'
            },
            {
                
                color: '#1a1a1a',
                link: '/login',
                title: 'Documents',
                label: 'Library · Files',
                description: 'Personal document library, shared class materials, file upload and organisation with version control'
            },
            {
                
                color: '#222222',
                link: '/login',
                title: 'Institutions',
                label: 'Classes · Teachers',
                description: 'Class creation with invite codes, student roster management, material uploads, and teacher-student communication'
            },
            {
                color: '#1e1e1e',
                link: '/login',
                title: 'Analytics',
                label: 'Insights · Risk',
                description: 'Institution-wide performance metrics, at-risk student identification, engagement tracking, and progress dashboards'
            }
        ];

        const canvas = document.getElementById('infinite-menu-canvas');
        const labelEl = document.getElementById('infiniteMenuLabel');
        const indexEl = document.getElementById('infiniteMenuIndex');
        const titleEl = document.getElementById('infiniteMenuTitle');
        const descEl  = document.getElementById('infiniteMenuDesc');
        const btnEl   = document.getElementById('infiniteMenuBtn');

        if (canvas) {
            let currentActiveItem = null;

            function handleActiveItem(index) {
                const total = infiniteMenuItems.length;
                const i = index % total;
                const item = infiniteMenuItems[i];
                currentActiveItem = item;
                indexEl.textContent = `${String(i + 1).padStart(2,'0')} / ${String(total).padStart(2,'0')}`;
                titleEl.textContent = item.title;
                descEl.textContent  = item.description;
            }

            function handleMovementChange(isMoving) {
                [labelEl, descEl, btnEl].forEach(el => {
                    el.classList.toggle('moving', isMoving);
                });
            }

            btnEl.addEventListener('click', () => {
                if (!currentActiveItem?.link) return;
                if (currentActiveItem.link.startsWith('http')) {
                    window.open(currentActiveItem.link, '_blank');
                } else {
                    window.location.href = currentActiveItem.link;
                }
            });

            try {
                const sketch = new InfiniteGridMenu(
                    canvas,
                    infiniteMenuItems,
                    handleActiveItem,
                    handleMovementChange,
                    sk => sk.run()
                );
                window.addEventListener('resize', () => sketch.resize());
                sketch.resize();
            } catch(e) {
                console.error('Infinite menu error:', e);
            }
        }
    });
})();
</script>

</body>
</html>